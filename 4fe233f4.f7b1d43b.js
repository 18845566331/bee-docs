(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{64:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return s})),a.d(t,"default",(function(){return b}));var n=a(2),r=a(6),c=(a(0),a(87)),i={title:"Clef External Signer",id:"bee-clef"},l={unversionedId:"installation/bee-clef",id:"installation/bee-clef",isDocsHomePage:!1,title:"Clef External Signer",description:"Bee makes use of Go Ethereum's external signer, Clef.",source:"@site/docs/installation/bee-clef.md",permalink:"/docs/installation/bee-clef",editUrl:"https://github.com/ethersphere/docs.github.io/blob/master/docs/installation/bee-clef.md",sidebar:"Balls",previous:{title:"Connectivity",permalink:"/docs/installation/connectivity"},next:{title:"Backups",permalink:"/docs/maintenance/backups"}},s=[{value:"Packages",id:"packages",children:[{value:"Ubuntu / Raspbian / Debian",id:"ubuntu--raspbian--debian",children:[]},{value:"CentOS",id:"centos",children:[]},{value:"MacOS",id:"macos",children:[]},{value:"Interact With Clef",id:"interact-with-clef",children:[]}]},{value:"Data Locations",id:"data-locations",children:[{value:"Bee-clef",id:"bee-clef",children:[]}]},{value:"Manual Installation",id:"manual-installation",children:[]}],o={rightToc:s};function b(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(n.a)({},o,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"Bee makes use of Go Ethereum's external signer, ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://geth.ethereum.org/docs/clef/tutorial"}),"Clef"),"."),Object(c.b)("p",null,"Because Bee must sign a lot of transactions automatically and quickly, a ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ethersphere/bee-clef"}),"Bee specific version of Clef, Bee-clef")," has been packaged which includes all the relevant configuration and implements the specific configuration needed to make Clef work with Bee."),Object(c.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(c.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(c.b)("h5",{parentName:"div"},Object(c.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(c.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(c.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"caution")),Object(c.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(c.b)("p",{parentName:"div"},"Clef will create a new Ethereum key pair for you during installation. Make sure you keep a ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/maintenance/backups"}),"backup")," of your key pair somewhere safe and secure!"))),Object(c.b)("h2",{id:"packages"},"Packages"),Object(c.b)("p",null,"Bee clef can be installed automatically using your system's package manager."),Object(c.b)("h3",{id:"ubuntu--raspbian--debian"},"Ubuntu / Raspbian / Debian"),Object(c.b)("h4",{id:"amd64"},"AMD64"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"wget https://github.com/ethersphere/bee-clef/releases/download/v0.4.1/bee-clef_0.4.1_amd64.deb\nsudo dpkg -i bee-clef_0.4.1_amd64.deb\n")),Object(c.b)("h4",{id:"arm-raspberry-pi"},"ARM (Raspberry Pi)"),Object(c.b)("h5",{id:"armv7"},"ARMv7"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"wget https://github.com/ethersphere/bee-clef/releases/download/v0.4.1/bee-clef_0.4.1_armv7.deb\nsudo dpkg -i bee-clef_0.4.1_armv7.deb\n")),Object(c.b)("h5",{id:"arm64"},"ARM64"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"wget https://github.com/ethersphere/bee-clef/releases/download/v0.4.1/bee-clef_0.4.1_arm64.deb\nsudo dpkg -i bee-clef_0.4.1_arm64.deb\n")),Object(c.b)("h3",{id:"centos"},"CentOS"),Object(c.b)("h4",{id:"amd64-1"},"AMD64"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"wget https://github.com/ethersphere/bee-clef/releases/download/v0.4.1/bee-clef_0.4.1_amd64.rpm\nsudo rpm -i bee-clef_0.4.1_amd64.rpm\n")),Object(c.b)("h4",{id:"arm-raspberry-pi-1"},"ARM (Raspberry Pi)"),Object(c.b)("h5",{id:"armv7-1"},"ARMv7"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"wget https://github.com/ethersphere/bee-clef/releases/download/v0.4.1/bee-clef_0.4.1_armv7.rpm\nsudo rpm -i bee-clef_0.4.1_armv7.rpm\n")),Object(c.b)("h5",{id:"arm64-1"},"ARM64"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"wget https://github.com/ethersphere/bee-clef/releases/download/v0.4.1/bee-clef_0.4.1_arm64.rpm\nsudo rpm -i bee-clef_0.4.1_arm64.rpm\n")),Object(c.b)("h3",{id:"macos"},"MacOS"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"brew tap ethersphere/tap\nbrew install swarm-clef\n")),Object(c.b)("p",null,"To run Bee Clef as a service now and on startup, run:"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"brew services start swarm-clef\n")),Object(c.b)("h3",{id:"interact-with-clef"},"Interact With Clef"),Object(c.b)("p",null,"Once Clef has been installed, it will begin running as a service using ",Object(c.b)("inlineCode",{parentName:"p"},"systemd"),"."),Object(c.b)("p",null,"To check Clef is running ok, we may use ",Object(c.b)("inlineCode",{parentName:"p"},"systemctl")," to query the status of the ",Object(c.b)("inlineCode",{parentName:"p"},"bee-clef")," service."),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"systemctl status bee-clef\n")),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{}),"\u25cf bee-clef.service - Bee Clef\n     Loaded: loaded (/lib/systemd/system/bee-clef.service; enabled; vendor preset: enabled)\n     Active: active (running) since Fri 2020-11-20 23:45:16 GMT; 1min 29s ago\n")),Object(c.b)("h2",{id:"data-locations"},"Data Locations"),Object(c.b)("h3",{id:"bee-clef"},"Bee-clef"),Object(c.b)("p",null,"Configuration files are stored in ",Object(c.b)("inlineCode",{parentName:"p"},"/etc/bee-clef/")),Object(c.b)("p",null,"Key material and other data is stored in ",Object(c.b)("inlineCode",{parentName:"p"},"/var/lib/bee-clef/")),Object(c.b)("h2",{id:"manual-installation"},"Manual Installation"),Object(c.b)("p",null,"To install Clef manually, first retrieve the relevant Clef binary from Ethereum's ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://geth.ethereum.org/downloads/"}),"Geth & Tools")," download page, or build directly from the ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ethereum/go-ethereum/wiki/Building-Ethereum"}),"source"),"."),Object(c.b)("p",null,"Because Bee needs Clef to sign many transactions automatically, we must run Clef as a service with relaxed permissions and rules set. To ensure Clef only signs transactions from Bee, we must protect the ",Object(c.b)("inlineCode",{parentName:"p"},"clef.ipc")," file by ",Object(c.b)("strong",{parentName:"p"},"creating a Bee user and setting permissions so that it is only possible for this user to make use of the ipc socket.")),Object(c.b)("p",null,"Additionally, Clef requires transaction signatures for the Bee's chequebook interaction."),Object(c.b)("p",null,"A shell script automating the post-initialisation permission changing and including the Clef config, ",Object(c.b)("inlineCode",{parentName:"p"},"clef-service"),", as well as the ",Object(c.b)("inlineCode",{parentName:"p"},"4byte.json")," transaction signature file and ",Object(c.b)("inlineCode",{parentName:"p"},"rules.js")," file can all be found in the ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/ethersphere/bee-clef/tree/master/packaging"}),"Bee-clef repository"),"."),Object(c.b)("p",null,"Finally, once Clef is running, simply ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/installation/configuration"}),"configure your Bee node")," to enable Clef using ",Object(c.b)("inlineCode",{parentName:"p"},"--clef-signer-enable")," and point Bee to the correct ipc socket using ",Object(c.b)("inlineCode",{parentName:"p"},"--clef-signer-endpoint"),"."))}b.isMDXComponent=!0},87:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(0),r=a.n(n);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var o=r.a.createContext({}),b=function(e){var t=r.a.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=b(e.components);return r.a.createElement(o.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,c=e.originalType,i=e.parentName,o=s(e,["components","mdxType","originalType","parentName"]),p=b(a),d=n,m=p["".concat(i,".").concat(d)]||p[d]||u[d]||c;return a?r.a.createElement(m,l(l({ref:t},o),{},{components:a})):r.a.createElement(m,l({ref:t},o))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var c=a.length,i=new Array(c);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var o=2;o<c;o++)i[o]=a[o];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"}}]);